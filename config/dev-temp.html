<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Estimation and Rounding Off</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: #000814;
      background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }
    
    /* Stars background */
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    .star {
      position: absolute;
      background-color: white;
      border-radius: 50%;
      animation: twinkle var(--twinkle-duration) infinite ease-in-out;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.2; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    
    .card {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      width: 80%;
      max-width: 950px;
      padding: 20px;
      text-align: center;
      position: relative;
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    h2, h3 {
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }
    
    svg { width: 100%; height: auto; }
    .caption {
      font-size: 1rem;
      margin-top: 12px;
      background: rgba(0, 0, 0, 0.5);
      padding: 8px 16px;
      border-radius: 10px;
      display: inline-block;
      color: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    button, select {
      margin: 8px;
      padding: 10px 16px;
      border: none;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: bold;
      cursor: pointer;
    }
    #replayBtn { 
      background: linear-gradient(90deg, #ff7b54, #ff5a9e); 
      color: #fff; 
      display: none; 
      box-shadow: 0 4px 15px rgba(255, 123, 84, 0.4);
    }
    #pauseBtn { 
      background: linear-gradient(90deg, #4CAF50, #45a049); 
      color: #fff; 
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
    }
    #replayBtn:hover { 
      background: linear-gradient(90deg, #ff5722, #e64a19);
      box-shadow: 0 6px 20px rgba(255, 87, 34, 0.6);
    }
    #pauseBtn:hover { 
      background: linear-gradient(90deg, #2e7d32, #1b5e20);
      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.6);
    }
    select { 
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.3);
      font-weight: normal;
      padding: 6px 12px;
    }
    select option {
      background: #1b2735;
      color: #ffffff;
    }
    .numText { 
      font-weight: bold; 
      font-size: 28px; 
      fill: #ffffff; 
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
    }
    .rounded { 
      font-weight: bold; 
      font-size: 26px; 
      fill: #4CAF50; 
      opacity: 0;
      text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
    }
    .rule { 
      font-weight: bold; 
      font-size: 22px; 
      fill: #2196F3; 
      opacity: 0;
      text-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
    }
    .nav-btn, .finish-btn {
      background: linear-gradient(90deg,#ff7b54,#ff5a9e);
      color: #fff;
      padding: 10px 16px;
      border-radius: 12px;
      border: none;
      box-shadow: 0 8px 20px rgba(0,0,0,0.12);
      font-weight: 700;
      cursor: pointer;
    }
    .finish-btn { 
      position: fixed; 
      right: 18px; 
      bottom: 18px; 
      z-index: 1200;
      box-shadow: 0 8px 20px rgba(255, 123, 84, 0.4);
    }
    
    /* Make SVG background transparent */
    svg {
      background: transparent;
    }
    
    /* Add glow effect to the rectangle */
    #example1 rect {
      fill: rgba(255, 217, 61, 0.8);
      filter: drop-shadow(0 0 10px rgba(255, 217, 61, 0.7));
    }
  </style>
</head>
<body>
  <!-- Stars container -->
  <div class="stars" id="starsContainer"></div>
  
  <div class="card">
    <h2 id="mainTitle">Knowing Our Numbers</h2>
    <h3 id="subTitle">Estimation and Rounding Off</h3>

    <!-- Language selector -->
    <label for="langSelect" style="color: #ffffff;">üåê Choose Language: </label>
    <select id="langSelect">
      <option value="en">English</option>
      <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
      <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)</option>
      <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)</option>
      <option value="or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü (Odia)</option>
    </select>

    <svg viewBox="0 0 1000 500">
      <!-- Base example -->
      <g id="example1">
        <rect x="350" y="50" width="250" height="90" rx="15" fill="#FFD93D"/>
        <text class="numText" x="475" y="110" text-anchor="middle">76,543</text>
      </g>
      <text id="round10" class="rounded" x="475" y="200" text-anchor="middle">Nearest 10 ‚Üí 76,540</text>
      <text id="round100" class="rounded" x="475" y="250" text-anchor="middle">Nearest 100 ‚Üí 76,500</text>
      <text id="round1000" class="rounded" x="475" y="300" text-anchor="middle">Nearest 1000 ‚Üí 77,000</text>

      <!-- Rule text -->
      <text id="rule" class="rule" x="500" y="360" text-anchor="middle">Rule: If digit < 5 ‚Üí Round Down | If digit ‚â• 5 ‚Üí Round Up</text>

      <!-- More examples -->
      <text id="ex2" class="rounded" x="475" y="400" text-anchor="middle">42 ‚Üí 40</text>
      <text id="ex3" class="rounded" x="475" y="430" text-anchor="middle">47 ‚Üí 50</text>
      <text id="ex4" class="rounded" x="475" y="460" text-anchor="middle">1,234 ‚Üí 1,000</text>
      <text id="ex5" class="rounded" x="475" y="490" text-anchor="middle">8,765 ‚Üí 9,000</text>
    </svg>

    <div id="caption" class="caption">Let's learn Estimation and Rounding Off!</div>
    <br>
    <button id="pauseBtn">‚è∏ Pause</button>
    <button id="replayBtn">üîÑ Replay</button>
    <button id="videoFinishBtn" class="nav-btn finish-btn">Finish</button>
  </div>

  <script>
    // Create twinkling stars
    function createStars() {
      const starsContainer = document.getElementById('starsContainer');
      const starCount = 150;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        
        // Random position
        const left = Math.random() * 100;
        const top = Math.random() * 100;
        
        // Random size
        const size = Math.random() * 3;
        
        // Random twinkle duration
        const duration = 2 + Math.random() * 5;
        
        // Random delay before starting animation
        const delay = Math.random() * 5;
        
        star.style.left = `${left}%`;
        star.style.top = `${top}%`;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.setProperty('--twinkle-duration', `${duration}s`);
        star.style.animationDelay = `${delay}s`;
        
        starsContainer.appendChild(star);
      }
    }
    
    // Initialize stars when page loads
    createStars();

    const caption = document.getElementById("caption");
    const replayBtn = document.getElementById("replayBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const langSelect = document.getElementById("langSelect");
    const mainTitle = document.getElementById("mainTitle");
    const subTitle = document.getElementById("subTitle");

    let paused = false;
    let currentStepIndex = 0;
    let currentLang = "en";

    // Multilingual content
    const translations = {
      en: {
        mainTitle: "Knowing Our Numbers",
        subTitle: "Estimation and Rounding Off",
        captions: [
          "Let's learn Estimation and Rounding Off!",
          "We start with the number seventy-six thousand, five hundred forty-three.",
          "Rounding to the nearest 10 ‚Üí Look at the ones digit (3). Since 3 < 5, round down to 76,540.",
          "Rounding to the nearest 100 ‚Üí Look at the tens digit (4). Since 4 < 5, round down to 76,500.",
          "Rounding to the nearest 1000 ‚Üí Look at the hundreds digit (5). Since 5 ‚â• 5, round up to 77,000.",
          "Rule: If digit < 5 ‚Üí Round Down. If digit ‚â• 5 ‚Üí Round Up.",
          "Example: 42 rounds to 40.",
          "Example: 47 rounds to 50.",
          "Example: 1,234 rounds to 1,000.",
          "Example: 8,765 rounds to 9,000."
        ],
        svgText: {
          round10: "Nearest 10 ‚Üí 76,540",
          round100: "Nearest 100 ‚Üí 76,500",
          round1000: "Nearest 1000 ‚Üí 77,000",
          rule: "Rule: If digit < 5 ‚Üí Round Down | If digit ‚â• 5 ‚Üí Round Up",
          ex2: "42 ‚Üí 40",
          ex3: "47 ‚Üí 50",
          ex4: "1,234 ‚Üí 1,000",
          ex5: "8,765 ‚Üí 9,000"
        },
        buttons: {
          pause: "‚è∏ Pause",
          play: "‚ñ∂ Play",
          replay: "üîÑ Replay",
          finish: "Finish"
        }
      },
      hi: {
        mainTitle: "‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§ú‡§æ‡§®‡§®‡§æ",
        subTitle: "‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§®",
        captions: [
          "‡§ö‡§≤‡•ã ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§® ‡§∏‡•Ä‡§ñ‡§§‡•á ‡§π‡•à‡§Ç!",
          "‡§π‡§Æ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§õ‡§ø‡§π‡§§‡•ç‡§§‡§∞ ‡§π‡§ú‡§æ‡§∞ ‡§™‡§æ‡§Ç‡§ö ‡§∏‡•å ‡§§‡§ø‡§Ø‡§æ‡§≤‡•Ä‡§∏ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§",
          "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 10 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‚Üí ‡§á‡§ï‡§æ‡§à ‡§Ö‡§Ç‡§ï (3) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§ ‡§ö‡•Ç‡§Ç‡§ï‡§ø 3 < 5, ‡§á‡§∏‡•á 76,540 ‡§§‡§ï ‡§ò‡§ü‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 100 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‚Üí ‡§¶‡§π‡§æ‡§à ‡§Ö‡§Ç‡§ï (4) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§ ‡§ö‡•Ç‡§Ç‡§ï‡§ø 4 < 5, ‡§á‡§∏‡•á 76,500 ‡§§‡§ï ‡§ò‡§ü‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 1000 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‚Üí ‡§∏‡•à‡§ï‡§°‡§º‡§æ ‡§Ö‡§Ç‡§ï (5) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§ ‡§ö‡•Ç‡§Ç‡§ï‡§ø 5 ‚â• 5, ‡§á‡§∏‡•á 77,000 ‡§§‡§ï ‡§¨‡§¢‡§º‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§®‡§ø‡§Ø‡§Æ: ‡§Ø‡§¶‡§ø ‡§Ö‡§Ç‡§ï < 5 ‚Üí ‡§ò‡§ü‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§Ö‡§Ç‡§ï ‚â• 5 ‚Üí ‡§¨‡§¢‡§º‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§â‡§¶‡§æ‡§π‡§∞‡§£: 42 ‡§ï‡•ã 40 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§â‡§¶‡§æ‡§π‡§∞‡§£: 47 ‡§ï‡•ã 50 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§â‡§¶‡§æ‡§π‡§∞‡§£: 1,234 ‡§ï‡•ã 1,000 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
          "‡§â‡§¶‡§æ‡§π‡§∞‡§£: 8,765 ‡§ï‡•ã 9,000 ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§"
        ],
        svgText: {
          round10: "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 10 ‚Üí 76,540",
          round100: "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 100 ‚Üí 76,500",
          round1000: "‡§®‡§ø‡§ï‡§ü‡§§‡§Æ 1000 ‚Üí 77,000",
          rule: "‡§®‡§ø‡§Ø‡§Æ: ‡§Ø‡§¶‡§ø ‡§Ö‡§Ç‡§ï < 5 ‚Üí ‡§ò‡§ü‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç | ‡§Ø‡§¶‡§ø ‡§Ö‡§Ç‡§ï ‚â• 5 ‚Üí ‡§¨‡§¢‡§º‡§æ‡§ï‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç",
          ex2: "42 ‚Üí 40",
          ex3: "47 ‚Üí 50",
          ex4: "1,234 ‚Üí 1,000",
          ex5: "8,765 ‚Üí 9,000"
        },
        buttons: {
          pause: "‚è∏ ‡§∞‡•ã‡§ï‡•á‡§Ç",
          play: "‚ñ∂ ‡§ö‡§≤‡§æ‡§è‡§Ç",
          replay: "üîÑ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ö‡§≤‡§æ‡§è‡§Ç",
          finish: "‡§∏‡§Æ‡§æ‡§™‡•ç‡§§"
        }
      },
      ta: {
        mainTitle: "‡Æé‡Æ£‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æ±‡Æø‡Æ§‡Æ≤‡Øç",
        subTitle: "‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÄ‡Æü‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç",
        captions: [
          "‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÄ‡Æü‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æ§‡Æ≤‡Øà‡Æï‡Øç ‡Æï‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Øç‡Æï‡Øä‡Æ≥‡Øç‡Æµ‡Øã‡ÆÆ‡Øç!",
          "‡Æ®‡Ææ‡ÆÆ‡Øç ‡Æé‡Æ¥‡ØÅ‡Æ™‡Æ§‡Øç‡Æ§‡Ææ‡Æ±‡ØÅ ‡ÆÜ‡ÆØ‡Æø‡Æ∞‡ÆÆ‡Øç ‡Æê‡Æ®‡Øç‡Æ®‡ØÇ‡Æ±‡ØÅ ‡Æ®‡Ææ‡Æ±‡Øç‡Æ™‡Æ§‡Øç‡Æ§‡Øä‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æé‡Æ©‡Øç‡Æ± ‡Æé‡Æ£‡Øç‡Æ£‡ØÅ‡Æü‡Æ©‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ‡Æï‡Æø‡Æ±‡Øã‡ÆÆ‡Øç.",
          "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 10 ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç ‚Üí ‡Æí‡Æ©‡Øç‡Æ±‡ØÅ‡Æï‡Æ≥‡Æø‡Æ©‡Øç ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Æ§‡Øç‡Æ§‡Øà (3) ‡Æ™‡Ææ‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç. 3 < 5 ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡Ææ‡Æ≤‡Øç, 76,540 ‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 100 ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç ‚Üí ‡Æ™‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Æ≥‡Æø‡Æ©‡Øç ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Æ§‡Øç‡Æ§‡Øà (4) ‡Æ™‡Ææ‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç. 4 < 5 ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡Ææ‡Æ≤‡Øç, 76,500 ‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ±‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 1000 ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç ‚Üí ‡Æ®‡ØÇ‡Æ±‡ØÅ‡Æï‡Æ≥‡Æø‡Æ©‡Øç ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Æ§‡Øç‡Æ§‡Øà (5) ‡Æ™‡Ææ‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç. 5 ‚â• 5 ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡Ææ‡Æ≤‡Øç, 77,000 ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÖ‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡Æµ‡Æø‡Æ§‡Æø: ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ÆÆ‡Øç < 5 ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‚Üí ‡Æï‡ØÅ‡Æ±‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç. ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ÆÆ‡Øç ‚â• 5 ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‚Üí ‡ÆÖ‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ: 42 ‡Æê 40 ‡ÆÜ‡Æï ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ: 47 ‡Æê 50 ‡ÆÜ‡Æï ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ: 1,234 ‡Æê 1,000 ‡ÆÜ‡Æï ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç.",
          "‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ: 8,765 ‡Æê 9,000 ‡ÆÜ‡Æï ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç."
        ],
        svgText: {
          round10: "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 10 ‚Üí 76,540",
          round100: "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 100 ‚Üí 76,500",
          round1000: "‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ 1000 ‚Üí 77,000",
          rule: "‡Æµ‡Æø‡Æ§‡Æø: ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ÆÆ‡Øç < 5 ‚Üí ‡Æï‡ØÅ‡Æ±‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç | ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ÆÆ‡Øç ‚â• 5 ‚Üí ‡ÆÖ‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æü‡Øç‡Æü‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç",
          ex2: "42 ‚Üí 40",
          ex3: "47 ‚Üí 50",
          ex4: "1,234 ‚Üí 1,000",
          ex5: "8,765 ‚Üí 9,000"
        },
        buttons: {
          pause: "‚è∏ ‡Æá‡Æü‡Øà‡Æ®‡Æø‡Æ±‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ",
          play: "‚ñ∂ ‡Æá‡ÆØ‡Æï‡Øç‡Æï‡ØÅ",
          replay: "üîÑ ‡ÆÆ‡ØÄ‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æá‡ÆØ‡Æï‡Øç‡Æï‡ØÅ",
          finish: "‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï"
        }
      },
      te: {
        mainTitle: "‡∞Æ‡∞® ‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø‡∞≤‡∞®‡±Å ‡∞§‡±Ü‡∞≤‡±Å‡∞∏‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç",
        subTitle: "‡∞Ö‡∞Ç‡∞ö‡∞®‡∞æ ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç",
        captions: [
          "‡∞Ö‡∞Ç‡∞ö‡∞®‡∞æ ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç ‡∞®‡±á‡∞∞‡±ç‡∞ö‡±Å‡∞ï‡±Å‡∞Ç‡∞¶‡∞æ‡∞Ç!",
          "‡∞Æ‡±á‡∞Æ‡±Å ‡∞°‡±Ü‡∞¨‡±ç‡∞¨‡±à ‡∞Ü‡∞∞‡±Å ‡∞µ‡±á‡∞≤ ‡∞ê‡∞¶‡±Å ‡∞µ‡∞Ç‡∞¶‡∞≤ ‡∞®‡∞≤‡∞≠‡±à ‡∞Æ‡±Ç‡∞°‡±Å ‡∞Ö‡∞®‡±á ‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø‡∞§‡±ã ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞∏‡±ç‡∞§‡∞æ‡∞Æ‡±Å.",
          "‡∞∏‡∞Æ‡±Ä‡∞™ 10‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç ‚Üí ‡∞í‡∞ï‡∞ü‡±ç‡∞≤ ‡∞Ö‡∞Ç‡∞ï‡±Ü‡∞®‡±Å (3) ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø. 3 < 5 ‡∞ï‡∞æ‡∞¨‡∞ü‡±ç‡∞ü‡∞ø, 76,540‡∞ï‡∞ø ‡∞§‡∞ó‡±ç‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞∏‡∞Æ‡±Ä‡∞™ 100‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç ‚Üí ‡∞™‡∞¶‡±Å‡∞≤ ‡∞Ö‡∞Ç‡∞ï‡±Ü‡∞®‡±Å (4) ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø. 4 < 5 ‡∞ï‡∞æ‡∞¨‡∞ü‡±ç‡∞ü‡∞ø, 76,500‡∞ï‡∞ø ‡∞§‡∞ó‡±ç‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞∏‡∞Æ‡±Ä‡∞™ 1000‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞Ç ‚Üí ‡∞µ‡∞Ç‡∞¶‡∞≤ ‡∞Ö‡∞Ç‡∞ï‡±Ü‡∞®‡±Å (5) ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø. 5 ‚â• 5 ‡∞ï‡∞æ‡∞¨‡∞ü‡±ç‡∞ü‡∞ø, 77,000‡∞ï‡∞ø ‡∞™‡±Ü‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞®‡∞ø‡∞Ø‡∞Æ‡∞Ç: ‡∞Ö‡∞Ç‡∞ï‡±Ü < 5 ‡∞Ö‡∞Ø‡∞ø‡∞§‡±á ‚Üí ‡∞§‡∞ó‡±ç‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø. ‡∞Ö‡∞Ç‡∞ï‡±Ü ‚â• 5 ‡∞Ö‡∞Ø‡∞ø‡∞§‡±á ‚Üí ‡∞™‡±Ü‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£: 42‡∞®‡∞ø 40‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£: 47‡∞®‡∞ø 50‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£: 1,234‡∞®‡∞ø 1,000‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.",
          "‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£: 8,765‡∞®‡∞ø 9,000‡∞ï‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø."
        ],
        svgText: {
          round10: "‡∞∏‡∞Æ‡±Ä‡∞™ 10 ‚Üí 76,540",
          round100: "‡∞∏‡∞Æ‡±Ä‡∞™ 100 ‚Üí 76,500",
          round1000: "‡∞∏‡∞Æ‡±Ä‡∞™ 1000 ‚Üí 77,000",
          rule: "‡∞®‡∞ø‡∞Ø‡∞Æ‡∞Ç: ‡∞Ö‡∞Ç‡∞ï‡±Ü < 5 ‚Üí ‡∞§‡∞ó‡±ç‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø | ‡∞Ö‡∞Ç‡∞ï‡±Ü ‚â• 5 ‚Üí ‡∞™‡±Ü‡∞Ç‡∞ö‡∞ø ‡∞™‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø",
          ex2: "42 ‚Üí 40",
          ex3: "47 ‚Üí 50",
          ex4: "1,234 ‚Üí 1,000",
          ex5: "8,765 ‚Üí 9,000"
        },
        buttons: {
          pause: "‚è∏ ‡∞µ‡∞ø‡∞∞‡∞æ‡∞Æ‡∞Ç",
          play: "‚ñ∂ ‡∞™‡±ç‡∞≤‡±á",
          replay: "üîÑ ‡∞Æ‡∞≥‡±ç‡∞≥‡±Ä ‡∞™‡±ç‡∞≤‡±á",
          finish: "‡∞Æ‡±Å‡∞ó‡∞ø‡∞Ç‡∞™‡±Å"
        }
      },
      or: {
        mainTitle: "‡¨Ü‡¨Æ‡¨∞ ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡≠Å ‡¨ú‡¨æ‡¨£‡¨ø‡¨¨‡¨æ",
        subTitle: "‡¨Ü‡¨ï‡¨≥‡¨® ‡¨è‡¨¨‡¨Ç ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ",
        captions: [
          "‡¨Ü‡¨∏‡¨®‡≠ç‡¨§‡≠Å ‡¨Ü‡¨ï‡¨≥‡¨® ‡¨è‡¨¨‡¨Ç ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨∂‡¨ø‡¨ñ‡¨ø‡¨¨‡¨æ!",
          "‡¨Ü‡¨Æ‡≠á ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ ‡¨∏‡¨§‡≠Å‡¨∞‡≠Ä ‡¨π‡¨ú‡¨æ‡¨∞ ‡¨™‡¨æ‡¨û‡≠ç‡¨ö ‡¨∂‡¨π ‡¨§‡¨ø‡¨∞‡¨ø‡¨∂‡¨ø‡¨Ü ‡¨∞‡≠Å ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡≠Å‡•§",
          "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 10 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‚Üí ‡¨è‡¨ï‡¨ï ‡¨Ö‡¨ô‡≠ç‡¨ï (3) ‡¨¶‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨Ø‡≠á‡¨π‡≠á‡¨§‡≠Å 3 < 5, 76,540 ‡¨ï‡≠Å ‡¨ï‡¨Æ‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 100 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‚Üí ‡¨¶‡¨∂‡¨ï ‡¨Ö‡¨ô‡≠ç‡¨ï (4) ‡¨¶‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨Ø‡≠á‡¨π‡≠á‡¨§‡≠Å 4 < 5, 76,500 ‡¨ï‡≠Å ‡¨ï‡¨Æ‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 1000 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‚Üí ‡¨∂‡¨π‡≠á ‡¨Ö‡¨ô‡≠ç‡¨ï (5) ‡¨¶‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨Ø‡≠á‡¨π‡≠á‡¨§‡≠Å 5 ‚â• 5, 77,000 ‡¨ï‡≠Å ‡¨¨‡¨¢‡¨º‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨®‡¨ø‡≠ü‡¨Æ: ‡¨Ø‡¨¶‡¨ø ‡¨Ö‡¨ô‡≠ç‡¨ï < 5 ‚Üí ‡¨ï‡¨Æ‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨Ø‡¨¶‡¨ø ‡¨Ö‡¨ô‡≠ç‡¨ï ‚â• 5 ‚Üí ‡¨¨‡¨¢‡¨º‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£: 42 ‡¨ï‡≠Å 40 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£: 47 ‡¨ï‡≠Å 50 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£: 1,234 ‡¨ï‡≠Å 1,000 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
          "‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£: 8,765 ‡¨ï‡≠Å 9,000 ‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§"
        ],
        svgText: {
          round10: "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 10 ‚Üí 76,540",
          round100: "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 100 ‚Üí 76,500",
          round1000: "‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ 1000 ‚Üí 77,000",
          rule: "‡¨®‡¨ø‡≠ü‡¨Æ: ‡¨Ø‡¨¶‡¨ø ‡¨Ö‡¨ô‡≠ç‡¨ï < 5 ‚Üí ‡¨ï‡¨Æ‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å | ‡¨Ø‡¨¶‡¨ø ‡¨Ö‡¨ô‡≠ç‡¨ï ‚â• 5 ‚Üí ‡¨¨‡¨¢‡¨º‡¨æ‡¨á ‡¨™‡¨∞‡¨ø‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å",
          ex2: "42 ‚Üí 40",
          ex3: "47 ‚Üí 50",
          ex4: "1,234 ‚Üí 1,000",
          ex5: "8,765 ‚Üí 9,000"
        },
        buttons: {
          pause: "‚è∏ ‡¨¨‡¨ø‡¨∞‡¨æ‡¨Æ",
          play: "‚ñ∂ ‡¨ö‡¨≤‡¨æ‡¨®‡≠ç‡¨§‡≠Å",
          replay: "üîÑ ‡¨™‡≠Å‡¨®‡¨É ‡¨ö‡¨≤‡¨æ‡¨®‡≠ç‡¨§‡≠Å",
          finish: "‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§"
        }
      }
    };

    const voicesMap = { 
      en: "en-IN", 
      hi: "hi-IN", 
      ta: "ta-IN", 
      te: "te-IN", 
      or: "or-IN" 
    };

    // Function to update all text elements based on selected language
    function updateLanguage() {
      currentLang = langSelect.value;
      const langData = translations[currentLang];
      
      // Update titles
      mainTitle.textContent = langData.mainTitle;
      subTitle.textContent = langData.subTitle;
      
      // Update SVG text elements
      document.getElementById('round10').textContent = langData.svgText.round10;
      document.getElementById('round100').textContent = langData.svgText.round100;
      document.getElementById('round1000').textContent = langData.svgText.round1000;
      document.getElementById('rule').textContent = langData.svgText.rule;
      document.getElementById('ex2').textContent = langData.svgText.ex2;
      document.getElementById('ex3').textContent = langData.svgText.ex3;
      document.getElementById('ex4').textContent = langData.svgText.ex4;
      document.getElementById('ex5').textContent = langData.svgText.ex5;
      
      // Update button text
      pauseBtn.textContent = langData.buttons.pause;
      replayBtn.textContent = langData.buttons.replay;
      document.getElementById('videoFinishBtn').textContent = langData.buttons.finish;
      
      // Update initial caption
      caption.textContent = langData.captions[0];
    }

    function speak(text, lang, callback) {
      if (paused) return;
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = voicesMap[lang] || "en-IN";
      utterance.rate = 0.95;
      utterance.onend = () => { if (!paused) callback(); };
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utterance);
    }

    function runStep() {
      if (currentStepIndex >= translations[currentLang].captions.length) {
        replayBtn.style.display = "inline-block";
        return;
      }
      caption.textContent = translations[currentLang].captions[currentStepIndex];

      // Animations
      if (currentStepIndex === 1) gsap.to("#example1", {duration: 1, scale: 1.1, yoyo: true, repeat: 1});
      if (currentStepIndex === 2) gsap.to("#round10", {duration: 1, opacity: 1, y: -10});
      if (currentStepIndex === 3) gsap.to("#round100", {duration: 1, opacity: 1, y: -10});
      if (currentStepIndex === 4) gsap.to("#round1000", {duration: 1, opacity: 1, y: -10});
      if (currentStepIndex === 5) gsap.to("#rule", {duration: 1, opacity: 1});
      if (currentStepIndex === 6) gsap.to("#ex2", {duration: 1, opacity: 1});
      if (currentStepIndex === 7) gsap.to("#ex3", {duration: 1, opacity: 1});
      if (currentStepIndex === 8) gsap.to("#ex4", {duration: 1, opacity: 1});
      if (currentStepIndex === 9) gsap.to("#ex5", {duration: 1, opacity: 1});

      speak(translations[currentLang].captions[currentStepIndex], currentLang, () => {
        currentStepIndex++;
        if (!paused) runStep();
      });
    }

    function playAnimation() {
      replayBtn.style.display = "none";
      paused = false;
      currentStepIndex = 0;
      currentLang = langSelect.value;

      gsap.set(["#round10","#round100","#round1000","#rule","#ex2","#ex3","#ex4","#ex5"], {opacity:0, y:0});
      gsap.set("#example1", {scale:1});

      runStep();
    }

    pauseBtn.addEventListener("click", () => {
      if (!paused) {
        paused = true;
        window.speechSynthesis.cancel();
        pauseBtn.textContent = translations[currentLang].buttons.play;
      } else {
        paused = false;
        pauseBtn.textContent = translations[currentLang].buttons.pause;
        runStep();
      }
    });

    replayBtn.addEventListener("click", playAnimation);

    // Language change event
    langSelect.addEventListener("change", () => {
      updateLanguage();
      if (!paused) {
        window.speechSynthesis.cancel();
        playAnimation();
      }
    });

    // Initialize with default language
    updateLanguage();
    playAnimation();

    // Finish button: save progress, show confetti, then navigate back to chapter
    const videoFinishBtn = document.getElementById('videoFinishBtn');
    videoFinishBtn?.addEventListener('click', ()=>{
      try {
        const key = 'aurraa:chapter1:progress';
        const data = JSON.parse(localStorage.getItem(key) || '{}');
        data['estimation'] = true;
        localStorage.setItem(key, JSON.stringify(data));
      } catch(e) { }

      // Increment badge when finished
      try { if (window.AURRAA && window.AURRAA.badge && typeof window.AURRAA.badge.inc === 'function') window.AURRAA.badge.inc(1); else window.dispatchEvent(new CustomEvent('aurraa:levelCompleted')); } catch(e){}

      if (window.confetti) confetti({ particleCount: 60, spread: 55, origin: { y: 0.6 } });
      setTimeout(()=> window.location.href = 'game-g6-rounding.html?open=estimation', 700);
    });
  </script>
</body>
</html>
